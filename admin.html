<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Admin — Transparência Doe Fácil</title>
<style>body{font-family:Arial;padding:20px}label{display:block;margin-top:10px}input,select,textarea{width:100%;padding:8px;margin-top:6px}button{margin-top:12px;padding:10px 16px;background:#ff781f;border:none;color:white;border-radius:6px}</style>
</head>
<body>
<h1>Registrar transação</h1>
<form id="form">
<label>Tipo
<select name="tipo">
<option value="entrada">Entrada</option>
<option value="saida">Saída</option>
</select>
</label>
<label>Data <input name="data" type="date" required></label>
<label>Valor <input name="valor" type="number" step="0.01" required></label>
<label>Categoria <input name="categoria" required></label>
<label>Descrição <textarea name="descricao"></textarea></label>
<button type="submit">Enviar</button>
</form>
<pre id="result"></pre>
<script>
const APPS = 'https://script.google.com/macros/s/SEU_WEBAPP_ID/exec';
document.getElementById('form').addEventListener('submit', async (e)=>{
e.preventDefault();
const fd = new FormData(e.target);
const payload = {};
fd.forEach((v,k)=> payload[k]=v);
try{
const res = await fetch(APPS + '?action=add', {
method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)
});
const json = await res.json();
document.getElementById('result').textContent = JSON.stringify(json, null, 2);
}catch(err){ document.getElementById('result').textContent = String(err); }
});
</script>
</body>
</html>